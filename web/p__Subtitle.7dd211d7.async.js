(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[707],{35880:function(H,C,o){"use strict";o.r(C),o.d(C,{default:function(){return yt}});var b=o(49426),Ct=o(91273),Q=o(17067),Zt=o(73667),N=o(1900),jt=o(85489),q=o(41132),R=o(73025),A=o(11108),O=o(9882),T=o(62377),Dt=o(53168),p=o(27274),It=o(30606),c=o(25861),bt=o(16613),k=o(5981),wt=o(9916),U=o(90757),P=o(59301),_=o(22056),tt=o(54348),et=o(18999),rt=o(89122),nt=o(60775),at=o.n(nt),st=null;function Et(l,a){{var n=new Set,i=_createForOfIteratorHelper(a.staff),t;try{for(i.s();!(t=i.n()).done;){var e=t.value;if(e!=="F"){var s=_createForOfIteratorHelper(a.skin[e]),u;try{for(s.s();!(u=s.n()).done;){var d=u.value;n.add(d)}}catch(v){s.e(v)}finally{s.f()}}}}catch(v){i.e(v)}finally{i.f()}var f=Array.from(n);if(f.length!==0&&!W(l.skin,f))return!1}var g=_createForOfIteratorHelper(st),x;try{for(g.s();!(x=g.n()).done;){var h=x.value;if(!W(l[h],a[h]))return!1}}catch(v){g.e(v)}finally{g.f()}if(l.titlestr===""&&l.tagstr===""&&l.typestr===""||a.title.toLowerCase().indexOf(l.titlestr.toLowerCase())!==-1)return!0;{var m=_createForOfIteratorHelper(a.tags),Z;try{for(m.s();!(Z=m.n()).done;){var E=Z.value;if(E.toLowerCase().indexOf(l.tagstr.toLowerCase())!==-1)return!0}}catch(v){m.e(v)}finally{m.f()}}{var y=_createForOfIteratorHelper(a.items),B;try{for(y.s();!(B=y.n()).done;){var j=B.value,S=_createForOfIteratorHelper(j.item),I;try{for(S.s();!(I=S.n()).done;){var M=I.value;if(M[0].toLowerCase().indexOf(l.typestr.toLowerCase())!==-1)return!0}}catch(v){S.e(v)}finally{S.f()}}}catch(v){y.e(v)}finally{y.f()}}return!1}function Bt(l){var a=new XMLHttpRequest;a.open("GET",l,!1),a.send(null);var n;try{n=JSON.parse(a.responseText)}catch(i){n={title:"error"}}finally{return n}}function Ft(l,a){var n=new XMLHttpRequest;n.open("POST",l,!1),n.setRequestHeader("Content-Type","application/json");var i=JSON.stringify(a);n.send(i);var t;try{t=JSON.parse(n.responseText)}catch(e){t={title:"error"}}finally{return t}}function X(l){var a=new XMLHttpRequest;a.open("GET",l,!1),a.send(null);var n;if(a.status!==200)throw a.status;try{n=a.responseText}catch(i){throw n="error http",n}finally{return n}}function K(l){for(var a=[],n=l.length-1;n>=0;n--)a.push(l[n]);return a}function W(l,a){return l.length+a.length!==Array.from(new Set([].concat(_toConsumableArray(l),_toConsumableArray(a)))).length}var ot=["https://raw.githubusercontent.com/BlackStarStar/XingTong-Subtitle-Database/main","https://cdn.jsdelivr.net/gh/BlackStarStar/XingTong-Subtitle-Database@latest"],Rt="8001",lt="https://apihk.asdb.live/Api/Subtitle_Search/sub_search",it=1,w="https://raw-gh.gcdn.mirr.one/BlackStarStar/XingTong-Subtitle-Database/main/db",L={RunOnLocal:it!==0,sourceUrl:ot[1],queryAPI:lt,MainJsonAPI:w+"/Main_Data.json",IndexerAPI:w+"/Indexer_Data",SubtitlesAPI:w+"/",SearchWordsAPI:w+"/Search_Data.json"},ut=o(85026),ct=o(55790),dt=o.n(ct),At=o(84832),r=o(37712),$=U.Z.Title,G=U.Z.Text,ht=k.Z.Search;function Ot(l,a){var n=0;return n}var vt="yellow";function ft(l){var a=L.SubtitlesAPI+l+".srt",n="",i=[];try{n=X(a)}catch(u){throw console.error("getSubtitles fail, status:"+u.toString()),a="https://cdn.jsdelivr.net/gh/BlackStarStar/XingTong-Subtitle-Database@latest/db/"+l+".srt",n=X(a),source}for(var t=n.split(`
`),e=0;e<t.length-2;e+=4){var s=t[e]+"|"+t[e+1]+"|"+t[e+2];i.push(s)}return i=[i],i}var pt=[{title:"\u65E5\u671F",width:80,dataIndex:"date"},{title:"\u65F6\u95F4",width:80,dataIndex:"hour"},{title:"BV\u53F7",width:80,dataIndex:"bv",render:function(a){return(0,r.jsx)("a",{href:"https://www.bilibili.com/"+a,target:"_blank",onClick:function(i){i.stopPropagation()},children:a})}},{title:"\u6807\u9898",dataIndex:"title",render:function(a){return(0,r.jsx)(p.Z,{children:(0,r.jsx)(c.Z,{md:12,children:a})})}}],mt=function(l){(0,O.Z)(n,l);var a=(0,T.Z)(n);function n(i){var t;return(0,R.Z)(this,n),t=a.call(this,i),t.state={input:""},t.handleSearch=function(e){t.props.parent.handleSearch(t.state.input)},t.handleClear=function(e){t.setState({input:""});var s=t.props.parent.props.initDatasrc;t.props.parent.setState({dataSource:s,searchWords:"",keyword:"",currentID:0})},t.handleReverse=function(e){t.props.parent.handleReverse()},t}return(0,A.Z)(n,[{key:"render",value:function(){var t=this;return(0,r.jsxs)(q.Z,{onKeyDown:function(s){s.keyCode===13&&t.handleSearch(s)},actions:[(0,r.jsx)(tt.Z,{title:"\u9006\u5E8F",onClick:this.handleReverse}),(0,r.jsx)(et.Z,{title:"\u6E05\u9664\u9009\u62E9",onClick:this.handleClear}),(0,r.jsx)(rt.Z,{title:"\u641C\u7D22",onClick:this.handleSearch})],children:[(0,r.jsx)(p.Z,{children:(0,r.jsx)(c.Z,{xs:24,md:24,align:"middle",children:(0,r.jsx)($,{level:2,children:"\u5B57\u5E55\u5E93\u68C0\u7D22"})})}),(0,r.jsxs)(p.Z,{style:{height:"50px"},children:[(0,r.jsx)(c.Z,{xs:0,md:6}),(0,r.jsx)(c.Z,{xs:24,md:12,align:"middle",children:(0,r.jsx)(k.Z,{style:{borderRadius:"50px"},placeholder:"\u5355\u6761\u5B57\u5E55\u68C0\u7D22\u{1F50D}",onChange:function(s){t.setState({input:s.target.value})},value:this.state.input})}),(0,r.jsx)(c.Z,{md:6,align:"middle"})]})]})}}]),n}(P.Component),gt=function(l){(0,O.Z)(n,l);var a=(0,T.Z)(n);function n(i){var t;return(0,R.Z)(this,n),t=a.call(this,i),t.state={dataSource:t.props.initDatasrc,isModalVisible:!1,displayBV:"",searchWords:"",currentID:0,keyword:"",searchJson:t.props.searchJson,loading:!0,hasLine:0,hasStr:0},t.handleCancel=function(){t.setState({isModalVisible:!1,currentID:0})},t.onSearch=function(e){t.setState({keyword:e.trim()}),t.setState({hasLine:0})},t.handleSearch=function(e){if(e!=""){t.setState({dataSource:t.props.initDatasrc}),e=e.trim(),t.setState({searchWords:e});var s=[];t.props.initDatasrc.map(function(d){t.props.searchJson.hasOwnProperty(d.bv)?t.props.searchJson[d.bv].includes(e)&&s.push(d):console.log(d.bv+"\u7F3A\u5931")}),t.setState({dataSource:s});var u=s.length;N.default.info("\u5171"+u.toString()+"\u6761\u641C\u7D22\u7ED3\u679C\u5DF2\u5C55\u793A")}else N.default.error("\u8BF7\u8F93\u5165\u641C\u7D22\u5185\u5BB9")},t.scrollTop=function(){var e=document.getElementById("Table-top");e.scrollIntoView({behavior:"auto"})},t.scrollNext=function(e){var s=document.getElementsByClassName(e);if(s.length!==0){var u=t.state.currentID;s[u].scrollIntoView({behavior:"smooth"}),u>=s.length-1?t.setState({currentID:0}):t.setState({currentID:u+1})}},t.scrollPre=function(e){var s=document.getElementsByClassName(e);if(s.length!=0){var u=t.state.currentID;s[u].scrollIntoView({behavior:"smooth"}),u<=0?t.setState({currentID:s.length-1}):t.setState({currentID:u-1})}},t}return(0,A.Z)(n,[{key:"componentDidUpdate",value:function(){var t=this.props,e=t.reRender,s=t.parent,u=t.initDatasrc;e&&(this.setState({dataSource:u}),s.setState({reRender:!1}))}},{key:"handleReverse",value:function(){var t=K(this.state.dataSource);this.setState({dataSource:t})}},{key:"render",value:function(){var t=this,e=this.state,s=e.isModalVisible,u=e.displayBV,d=e.searchWords,f=e.loading,g=[];return u!==""&&s&&(g=ft(u)),(0,r.jsxs)(_.ZP,{children:[(0,r.jsx)(mt,{parent:this}),(0,r.jsx)(p.Z,{style:{marginTop:"20px"},children:(0,r.jsx)(c.Z,{xs:24,md:24,children:(0,r.jsx)(ut.ZP,{columns:this.props.initColumns,rowKey:"key",dataSource:this.state.dataSource,search:!1,loading:f,onLoad:this.state.loading=!1,onRow:function(h){return{onClick:function(Z){t.setState({isModalVisible:!0,displayBV:h.bv,part_time:h.part_time,title:h.title}),d!=""&&t.setState({keyword:d})},style:{cursor:"pointer"}}}})})}),(0,r.jsxs)(Q.Z,{id:"modal",visible:s,maskClosable:!0,onCancel:this.handleCancel,footer:null,destroyOnClose:!0,width:600,loading:!0,children:[(0,r.jsxs)(p.Z,{children:[(0,r.jsx)(c.Z,{xs:24,md:24,align:"middle",children:(0,r.jsx)($,{level:3,children:this.state.title})}),(0,r.jsx)(c.Z,{justify:"center"})]}),(0,r.jsx)(p.Z,{justify:"end",children:(0,r.jsx)(ht,{placeholder:"\u641C\u7D22",allowClear:!0,style:{width:150},onChange:function(h){t.setState({keyword:h.target.value})},value:this.state.keyword,onSearch:this.onSearch})}),(0,r.jsxs)(p.Z,{children:[(0,r.jsx)(c.Z,{xs:3,md:3,children:"\u5E8F\u53F7"}),(0,r.jsx)(c.Z,{xs:10,md:10,children:"\u65F6\u95F4"}),(0,r.jsx)(c.Z,{xs:11,md:11,children:"\u5B57\u5E55"})]}),(0,r.jsxs)(p.Z,{style:{borderBottom:"2px solid"},children:[(0,r.jsx)(G,{type:"secondary",children:"\u6309\u4E0B\u9F20\u6807\u6EDA\u8F6E\u952E\u5FEB\u901F\u6D4F\u89C8"}),(0,r.jsx)(G,{type:"secondary",style:{display:u=="BV1aq4y1974i"?"":"none"},children:"     !!!!!\u751F\u65E5\u4F1A\u5B57\u5E55\u8F83\u957F\u8FD8\u672A\u6574\u7406!!!!!"})]}),(0,r.jsx)(p.Z,{children:(0,r.jsx)(c.Z,{span:24,style:{height:"500px",overflowY:"scroll"},children:g.map(function(x,h){var m=[];return t.state.hasLine=0,x.map(function(Z,E){var y=Z.split("|"),B=y[0],j=y[1],S=y[2],I=!1;S.includes(t.state.keyword.trim())&&(I=!0,t.state.keyword.trim()!==""&&(t.state.hasLine+=1,console.log(S)));for(var M=parseInt(j.split("-->")[0].split(":")[0]),v=parseInt(j.split("-->")[0].split(":")[1]),St=parseInt(j.split("-->")[0].split(":")[2].split(",")[0]),J=t.state.part_time,F=M*3600+60*v+St,V=0,D=0;D<J.length;D++)if(F<J[D]){V=D+1;break}else F=F-J[D],V=D+2;var Y="https://www.bilibili.com/"+u+"?p="+V+"&start_progress="+F*1e3,z="";S.toLowerCase().indexOf(d.toLowerCase())!==-1&&(z="active-highlight"),I&&m.push((0,r.jsxs)(p.Z,{style:{borderBottom:"1px dashed"},className:z,children:[(0,r.jsx)(c.Z,{xs:3,md:3,style:{color:"#B8A6D9"},children:B}),(0,r.jsx)(c.Z,{xs:10,md:10,children:(0,r.jsx)("a",{target:"_blank",href:Y,children:j})}),(0,r.jsx)(c.Z,{xs:11,md:11,style:{color:"#E799B0"},children:(0,r.jsx)(at(),{highlightStyle:{backgroundColor:vt,padding:0},searchWords:[t.state.keyword.trim()],autoEscape:!0,textToHighlight:S})})]},Y))}),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(p.Z,{children:(0,r.jsx)(c.Z,{style:{color:"#9AC8E2",borderBottom:"1px solid"},id:"Table-top",children:(0,r.jsx)("a",{target:"_blank",href:"https://www.bilibili.com/"+u+"?p="+(h+1),children:"\u5207\u7247"})})}),(0,r.jsx)(dt(),{rows:m})]})})})})]})]})}}]),n}(P.Component),xt=function(l){(0,O.Z)(n,l);var a=(0,T.Z)(n);function n(){var i;(0,R.Z)(this,n);for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];return i=a.call.apply(a,[this].concat(e)),i.state={mainJson:[],indexerList:[],reRender:!1},i}return(0,A.Z)(n,[{key:"cancelRerender",value:function(){this.setState({reRender:!1}),console.log("\u5DF2\u53D6\u6D88")}},{key:"componentDidMount",value:function(){var t=this;fetch(L.MainJsonAPI).then(function(e){return e.json().then(function(s){t.setState({mainJson:s.data,reRender:!0})})},function(e){console.error(e)}),fetch(L.SearchWordsAPI).then(function(e){return e.json().then(function(s){t.setState({searchJson:s})})},function(e){console.error(e)})}},{key:"render",value:function(){var t=this.state,e=t.mainJson,s=t.reRender,u=t.searchJson,d=[];for(var f in e){var g=void 0,x=void 0,h=void 0,m=void 0,Z=void 0;try{g=e[f].title,x=e[f].bv,h=e[f].date,m=e[f].time,Z=e[f].part_time}catch(y){console.error("mainJson parse fault for n: "+f)}d.push({key:f,date:h,hour:m,bv:x,title:g,part_time:Z})}d=K(d);var E={initColumns:pt,initDatasrc:d,reRender:s,parent:this,searchJson:u};return(0,r.jsx)(gt,(0,b.Z)({},E))}}]),n}(P.Component),yt=xt},96200:function(H){function C(o){var b=new Error("Cannot find module '"+o+"'");throw b.code="MODULE_NOT_FOUND",b}C.keys=function(){return[]},C.resolve=C,C.id=96200,H.exports=C},71346:function(){},52825:function(){},85783:function(){},77179:function(){},67845:function(){},37456:function(){},16718:function(){}}]);
